<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Level 100 Registration Form</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>Level 100 Registration Form</h1>
        <h2>National Union of Presbyterian Students - Ghana</h2>
        <h3>(AAMUSTED Local)</h3>
        <hr>
        <form id="registrationForm">
            <!-- Personal Details -->
            <fieldset>
                <legend>Personal Details</legend>
                <label for="first_name">First Name:</label>
                <input type="text" id="first_name" name="first_name" required>

                <label for="last_name">Last Name:</label>
                <input type="text" id="last_name" name="last_name" required>

                <label for="other_name">Other Name:</label>
                <input type="text" id="other_name" name="other_name">

                <label for="date_of_birth">Date of Birth:</label>
                <input type="date" id="date_of_birth" name="date_of_birth" required>

                <label for="gender">Gender:</label>
                <select name="gender" id="gender" required>
                    <option value=""></option>
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                </select>

                <label for="marital_status">Marital Status:</label>
                <select name="marital_status" id="marital_status" required>
                    <option value=""></option>
                    <option value="single">Single</option>
                    <option value="married">Married</option>
                    <option value="divorced">Divorced</option>
                    <option value="widowed">Widowed</option>
                </select>

                <label for="contact">Contact:</label>
                <input type="tel" id="contact" name="contact" required>

                <label for="email">Email:</label>
                <input type="email" id="email" name="email" required>
            </fieldset>

            <!-- Emergency Details -->
            <fieldset>
                <legend>Emergency Details</legend>
                <label for="emergency_contact_1">Emergency Contact:</label>
                <input type="tel" id="emergency_contact_1" name="emergency_contacts[]" required>
            </fieldset>

            <!-- Educational Details -->
            <fieldset>
                <legend>Educational Details</legend>
                <label for="program">Program of Studies:</label>
                <input type="text" list="programs" id="program" name="program" required>
                <datalist id="programs">
                    <option value="B. A. Arabic Education">
                        <option value="B. A. English Education">
                        <option value="B. A. French Education">
                        <option value="B. A. French with English Education">
                        <option value="B. A. Social Studies with Economics Education">
                        <option value="B.Ed. Early Grade (Early Childhood)">
                        <option value="B. Sc. Fashion Design and Textiles Education">
                        <option value="B. Sc. Catering and Hospitality Education">
                        <option value="B. B. A. Secretarial Education">
                        <option value="B. Sc. Management Education">
                        <option value="B. Sc. Marketing">
                        <option value="B. B. A. Executive Office Administration">
                        <option value="B. Sc. Marketing and Entrepreneurship">
                        <option value="B.B.A. Human Resource Management">
                        <option value="B. Sc. Economics with Social Studies Education">
                        <option value="B. Sc. Economics Education">
                        <option value="B. Sc. Accounting Education">
                        <option value="B. Sc. Admin Accounting">
                        <option value="B. Sc. Procurement and Supply Chain Management">
                        <option value="B. Sc. Banking and Finance">
                        <option value="B. Sc. Business Information Systems">
                        <option value="B. Sc. Mathematics Education">
                        <option value="B. Sc. Information Technology Education">
                        <option value="B.Sc. Information Technology">
                        <option value="B.Sc. Cybersecurity and Digital Forensics">
                        <option value="B. Sc. Automotive Engineering Technology Education">
                        <option value="B. Sc. Mechanical Engineering Technology Education">
                        <option value="B.Sc. Construction Technology and Management with Education">
                        <option value="B.Sc. Welding and Fabrication Engineering Technology Education">
                        <option value="B.Sc. Plumbing, Gas and Sanitary Technology">
                        <option value="B.Sc Civil Engineering">
                        <option value="B.Sc. Wood Technology with Education">
                        <option value="B. Sc. Electrical and Electronics Engineering Technology Education">
                        <option value="B.Sc. Mechanical Engineering Technology">
                        <option value="B.Sc. Electrical and Electronics Engineering">
                        <option value="2-year Post-Diploma in Construction Technology">
                        <option value="2-year Post-Diploma in Automotive Engineering Technology">
                        <option value="2-year Post-Diploma in Electrical and Electronics Engineering Technology">
                        <option value="2-year Diploma in Wood Technology">
                        <option value="2-year Diploma Business Admin Accounting">
                        <option value="Diploma in Human Resource Management">
                        <option value="Diploma in Office Management and Computer Applications">
                        <option value="2-year Diploma Business Admin Management">
                </datalist>
            </fieldset>

            <label for="Place_of_stay">Place Of Residence</label>
            <input type="text" id="Place_of_stay" name="Place_of_stay" required>

            <!-- Wings of Choice -->
            <fieldset>
                <legend>Wings of Choice</legend>
                <div class="wing-group">
                    <label><input type="checkbox" name="wings[]" value="Organizing"> Organizing</label>
                    <label><input type="checkbox" name="wings[]" value="Prayer Wing"> Prayer Wing</label>
                    <label><input type="checkbox" name="wings[]" value="Bible Studies Wing"> Bible Studies Wing</label>
                    <label><input type="checkbox" name="wings[]" value="Coordinating Wing"> Coordinating Wing</label>
                    <label><input type="checkbox" name="wings[]" value="Ushering"> Ushering</label>
                    <label><input type="checkbox" name="wings[]" value="Evangelism Wing"> Evangelism Wing</label>
                    <label><input type="checkbox" name="wings[]" value="Inspirers"> Inspirers</label>
                    <label><input type="checkbox" name="wings[]" value="Choir"> Choir</label>
                    <label><input type="checkbox" name="wings[]" value="Ladies Wing"> Ladies Wing</label>
                    <label><input type="checkbox" name="wings[]" value="Vessels of Inspiration"> Vessels of Inspiration</label>
                </div>
            </fieldset>

            <!-- Capture ID Picture -->
            <fieldset>
                <legend>Capture ID Picture</legend>
                <div>
                    <video id="video" autoplay playsinline></video>
                    <button type="button" id="captureBtn">Take Picture</button>
                    <canvas id="canvas" style="display: none;"></canvas>
                    <img id="capturedImage" alt="Captured Image" style="display: none;" />
                </div>
            </fieldset>

            <button type="submit" id="submitBtn">Generate PDF</button>
        </form>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script>
        const video = document.getElementById('video');
        const canvas = document.getElementById('canvas');
        const capturedImage = document.getElementById('capturedImage');
        const captureBtn = document.getElementById('captureBtn');

        // Start video stream
        navigator.mediaDevices
            .getUserMedia({ video: true })
            .then((stream) => {
                video.srcObject = stream;
            })
            .catch((err) => {
                console.error("Error accessing camera:", err);
            });

        // Capture image on button click
        captureBtn.addEventListener('click', () => {
            const context = canvas.getContext('2d');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            context.drawImage(video, 0, 0, canvas.width, canvas.height);
            const imageData = canvas.toDataURL('image/png');
            capturedImage.src = imageData;
            capturedImage.style.display = 'block';
        });

        document.getElementById('registrationForm').addEventListener('submit', function (e) {
            e.preventDefault(); // Prevent traditional form submission

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // Get form values
            const firstName = document.getElementById('first_name').value;
            const lastName = document.getElementById('last_name').value;
            const otherName = document.getElementById('other_name').value;
            const dateOfBirth = document.getElementById('date_of_birth').value;
            const gender = document.getElementById('gender').value;
            const maritalStatus = document.getElementById('marital_status').value;
            const contact = document.getElementById('contact').value;
            const email = document.getElementById('email').value;
            const emergencyContact = document.getElementById('emergency_contact_1').value;
            const program = document.getElementById('program').value;
            const placeOfStay = document.getElementById('Place_of_stay').value;
            const wings = Array.from(document.querySelectorAll('input[name="wings[]"]:checked')).map((checkbox) => checkbox.value).join(', ');

            const fullName = `${firstName} ${otherName} ${lastName}`.trim(); // Full Name

            // Initialize PDF layout
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(16);
            const title = "National Union of Presbyterian Students - Ghana (AAMUSTED Local)";
            const pageWidth = doc.internal.pageSize.width;
            const titleWidth = doc.getTextWidth(title);
            const xPos = (pageWidth - titleWidth) / 2;
            doc.text(title, xPos, 20);

            doc.setFontSize(12);
            doc.setFont('helvetica', 'normal');
            doc.text("2024 to 2028 Academic Year", 10, 40);

            let yOffset = 50;
            const lineHeight = 10;

            // Personal Details Section
            doc.setFont('helvetica', 'bold');
            doc.text("Personal Details", 10, yOffset);
            yOffset += lineHeight;

            doc.setFont('helvetica', 'normal');
            doc.text(`Full Name: ${fullName}`, 10, yOffset);
            yOffset += lineHeight;

            doc.text(`Date of Birth: ${dateOfBirth}`, 10, yOffset);
            yOffset += lineHeight;

            doc.text(`Gender: ${gender}`, 10, yOffset);
            yOffset += lineHeight;

            doc.text(`Marital Status: ${maritalStatus}`, 10, yOffset);
            yOffset += lineHeight;

            doc.text(`Contact: ${contact}`, 10, yOffset);
            yOffset += lineHeight;

            doc.text(`Email: ${email}`, 10, yOffset);
            yOffset += lineHeight;

            // Emergency Details Section
            doc.setFont('helvetica', 'bold');
            doc.text("Emergency Details", 10, yOffset);
            yOffset += lineHeight;

            doc.setFont('helvetica', 'normal');
            doc.text(`Emergency Contact: ${emergencyContact}`, 10, yOffset);
            yOffset += lineHeight;

            // Educational Details Section
            doc.setFont('helvetica', 'bold');
            doc.text("Educational Details", 10, yOffset);
            yOffset += lineHeight;

            doc.setFont('helvetica', 'normal');
            doc.text(`Program of Studies: ${program}`, 10, yOffset);
            yOffset += lineHeight;

            doc.text(`Place of Stay: ${placeOfStay}`, 10, yOffset);
            yOffset += lineHeight;

            // Wings Section
            doc.setFont('helvetica', 'bold');
            doc.text("Wings of Choice", 10, yOffset);
            yOffset += lineHeight;

            doc.setFont('helvetica', 'normal');
            doc.text(`Selected Wings: ${wings}`, 10, yOffset);

            // Attach captured image to the PDF
            if (capturedImage.src) {
                doc.addImage(capturedImage.src, 'PNG', 10, yOffset + 20, 50, 50);
            }

            // Save the PDF
            const fileName = `${fullName || 'Registration_Form'}.pdf`.replace(/[^a-zA-Z0-9]/g, '_');
            doc.save(fileName);
        });
    </script>
</body>
</html>
